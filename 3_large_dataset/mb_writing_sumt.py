# Writing a MrBayes blok with the information to run sumt on the trees in the posteriror sample
import os, argparse
os.chdir("/home/kris/dypsidinae/C_large_dataset/8.MrBayes_n/")

#Lists of genes that converged after the different number of runs
#genes not converged after 2.5 milion
v2=['gene1401', 'gene2480','gene274','gene1027', 'gene1038', 'gene1040', 'gene1051', 'gene106', 'gene1089', 'gene1090', 'gene1108', 'gene1121', 'gene1142', 'gene1151', 'gene1160', 'gene1167', 'gene1172', 'gene1200', 'gene1203', 'gene1211', 'gene1212', 'gene1279', 'gene1297', 'gene1305', 'gene1307', 'gene131', 'gene1338', 'gene1341', 'gene1342', 'gene1345', 'gene1346', 'gene1350', 'gene1351', 'gene1352', 'gene1371', 'gene1392', 'gene1402', 'gene1404', 'gene1417', 'gene1419', 'gene1424', 'gene1428', 'gene1429', 'gene1430', 'gene1439', 'gene143', 'gene1441', 'gene1446', 'gene1447', 'gene1457', 'gene1461', 'gene1462', 'gene1463', 'gene1470', 'gene1471', 'gene1483', 'gene1518', 'gene1522', 'gene1523', 'gene1527', 'gene152', 'gene1534', 'gene1539', 'gene1544', 'gene1545', 'gene1548', 'gene1558', 'gene1560', 'gene1567', 'gene1571', 'gene1576', 'gene1584', 'gene1585', 'gene1652', 'gene1658', 'gene1659', 'gene1665', 'gene1722', 'gene1725', 'gene1729', 'gene1730', 'gene1733', 'gene1776', 'gene1797', 'gene1819', 'gene1826', 'gene1827', 'gene1894', 'gene192', 'gene1937', 'gene1943', 'gene1945', 'gene2031', 'gene2032', 'gene2060', 'gene2061', 'gene2062', 'gene2142', 'gene2164', 'gene2180', 'gene2181', 'gene2188', 'gene2189', 'gene2209', 'gene2231', 'gene2263', 'gene2264', 'gene2267', 'gene2285', 'gene2295', 'gene2299', 'gene2318', 'gene2319', 'gene2340', 'gene2345', 'gene2346', 'gene2348', 'gene2391', 'gene2392', 'gene2393', 'gene2396', 'gene2404', 'gene2408', 'gene2415', 'gene2422', 'gene2423', 'gene2425', 'gene2435', 'gene2436', 'gene2505', 'gene2539', 'gene2543', 'gene2551', 'gene2554', 'gene2555', 'gene2571', 'gene2605', 'gene2606', 'gene2621', 'gene2622', 'gene2642', 'gene2652', 'gene2663', 'gene2703', 'gene2704', 'gene2772', 'gene2788', 'gene2789', 'gene2790', 'gene2795', 'gene2814', 'gene2825', 'gene2826', 'gene2835', 'gene2838', 'gene2861', 'gene2875', 'gene2904', 'gene2938', 'gene2949', 'gene2950', 'gene2954', 'gene296', 'gene2972', 'gene2976', 'gene2977', 'gene3004', 'gene3015', 'gene3023', 'gene3031', 'gene3039', 'gene3040', 'gene3062', 'gene3082', 'gene3087', 'gene3091', 'gene3097', 'gene3100', 'gene310', 'gene3111', 'gene3125', 'gene3172', 'gene3174', 'gene3201', 'gene3281', 'gene3282', 'gene3295', 'gene3301', 'gene3302', 'gene330', 'gene3316', 'gene3319', 'gene331', 'gene332', 'gene333', 'gene3344', 'gene3388', 'gene3393', 'gene3403', 'gene3414', 'gene3415', 'gene3436', 'gene3438', 'gene3439', 'gene3463', 'gene3464', 'gene3465', 'gene347', 'gene3482', 'gene3483', 'gene348', 'gene3518', 'gene3532', 'gene3609', 'gene3700', 'gene3732', 'gene3759', 'gene3772', 'gene3779', 'gene3806', 'gene3807', 'gene3811', 'gene3818', 'gene3822', 'gene3849', 'gene3858', 'gene3861', 'gene3870', 'gene3872', 'gene3884', 'gene3895', 'gene3896', 'gene3926', 'gene3942', 'gene3944', 'gene3948', 'gene3949', 'gene4007', 'gene4032', 'gene4041', 'gene409', 'gene4115', 'gene4128', 'gene4154', 'gene4176', 'gene4181', 'gene4183', 'gene4197', 'gene4198', 'gene4207', 'gene4213', 'gene4214', 'gene4227', 'gene4228', 'gene4235', 'gene4236', 'gene4253', 'gene4254', 'gene4264', 'gene4282', 'gene4317', 'gene4336', 'gene433', 'gene4343', 'gene439', 'gene4412', 'gene4419', 'gene4420', 'gene4435', 'gene4443', 'gene4444', 'gene4445', 'gene4446', 'gene4470', 'gene4474', 'gene4487', 'gene4488', 'gene456', 'gene4588', 'gene4614', 'gene4618', 'gene4619', 'gene4623', 'gene4624', 'gene4631', 'gene4635', 'gene4648', 'gene4668', 'gene4684', 'gene4685', 'gene4686', 'gene4687', 'gene4699', 'gene469', 'gene4701', 'gene4702', 'gene4706', 'gene4724', 'gene4728', 'gene4760', 'gene4761', 'gene4770', 'gene4774', 'gene4775', 'gene4795', 'gene4796', 'gene4797', 'gene4800', 'gene4801', 'gene4804', 'gene4805', 'gene4839', 'gene4857', 'gene4867', 'gene4868', 'gene4898', 'gene4899', 'gene4900', 'gene4904', 'gene4931', 'gene4932', 'gene4946', 'gene4993', 'gene4997', 'gene5001', 'gene5009', 'gene5010', 'gene5011', 'gene5013', 'gene5015', 'gene5017', 'gene5033', 'gene503', 'gene504', 'gene5072', 'gene5073', 'gene5087', 'gene5096', 'gene5098', 'gene5120', 'gene512', 'gene5163', 'gene5164', 'gene5165', 'gene5167', 'gene5232', 'gene5233', 'gene5234', 'gene5257', 'gene5259', 'gene5305', 'gene530', 'gene5320', 'gene5322', 'gene5323', 'gene5324', 'gene5325', 'gene534', 'gene5351', 'gene5361', 'gene5366', 'gene5367', 'gene5368', 'gene5370', 'gene5392', 'gene5399', 'gene5446', 'gene5447', 'gene5453', 'gene5463', 'gene560', 'gene561', 'gene566', 'gene570', 'gene572', 'gene607', 'gene608', 'gene61', 'gene623', 'gene625', 'gene636', 'gene63', 'gene649', 'gene650', 'gene667', 'gene694', 'gene695', 'gene69', 'gene724', 'gene729', 'gene730', 'gene73', 'gene754', 'gene774', 'gene807', 'gene812', 'gene853', 'gene855', 'gene86', 'gene883', 'gene884', 'gene888', 'gene88', 'gene896', 'gene89', 'gene904', 'gene910', 'gene911', 'gene928', 'gene932', 'gene935', 'gene939', 'gene961', 'gene972', 'gene988']

#genes not converged after 3.5 milion
v3=['gene1051', 'gene106', 'gene1090', 'gene1108', 'gene1121', 'gene1142', 'gene1151', 'gene1160', 'gene1172', 'gene1200', 'gene1203', 'gene1211', 'gene1279', 'gene1305', 'gene1338', 'gene1341', 'gene1342', 'gene1345', 'gene1346', 'gene1350', 'gene1351', 'gene1352', 'gene1371', 'gene1404', 'gene1417', 'gene1424', 'gene1439', 'gene1446', 'gene1447', 'gene1457', 'gene1461', 'gene1462', 'gene1463', 'gene1470', 'gene1471', 'gene1483', 'gene1518', 'gene1522', 'gene1523', 'gene1527', 'gene1539', 'gene1544', 'gene1545', 'gene1558', 'gene1560', 'gene1584', 'gene1585', 'gene1658', 'gene1659', 'gene1722', 'gene1729', 'gene1730', 'gene1733', 'gene1776', 'gene1797', 'gene1826', 'gene1894', 'gene1937', 'gene1945', 'gene2061', 'gene2062', 'gene2180', 'gene2188', 'gene2189', 'gene2209', 'gene2263', 'gene2264', 'gene2267', 'gene2285', 'gene2295', 'gene2318', 'gene2319', 'gene2340', 'gene2345', 'gene2346', 'gene2391', 'gene2392', 'gene2393', 'gene2404', 'gene2408', 'gene2422', 'gene2539', 'gene2543', 'gene2551', 'gene2554', 'gene2555', 'gene2605', 'gene2606', 'gene2621', 'gene2622', 'gene2652', 'gene2703', 'gene2704', 'gene2789', 'gene2795', 'gene2814', 'gene2838', 'gene2861', 'gene2875', 'gene2949', 'gene2950', 'gene2954', 'gene296', 'gene2972', 'gene2976', 'gene2977', 'gene3015', 'gene3031', 'gene3062', 'gene3087', 'gene3091', 'gene3100', 'gene310', 'gene3111', 'gene3125', 'gene3201', 'gene3282', 'gene3295', 'gene3301', 'gene3302', 'gene330', 'gene3316', 'gene3319', 'gene331', 'gene332', 'gene333', 'gene3344', 'gene3388', 'gene3403', 'gene3415', 'gene3436', 'gene3438', 'gene3439', 'gene3463', 'gene3464', 'gene3465', 'gene347', 'gene3482', 'gene3518', 'gene3532', 'gene3700', 'gene3732', 'gene3772', 'gene3806', 'gene3822', 'gene3858', 'gene3861', 'gene3870', 'gene3872', 'gene3895', 'gene3896', 'gene3942', 'gene3944', 'gene3948', 'gene4007', 'gene4041', 'gene4154', 'gene4181', 'gene4183', 'gene4197', 'gene4198', 'gene4214', 'gene4227', 'gene4228', 'gene4235', 'gene4253', 'gene4254', 'gene4264', 'gene4282', 'gene4336', 'gene433', 'gene439', 'gene4419', 'gene4420', 'gene4435', 'gene4443', 'gene4444', 'gene4445', 'gene4470', 'gene4487', 'gene4588', 'gene4618', 'gene4619', 'gene4623', 'gene4624', 'gene4635', 'gene4648', 'gene4668', 'gene4685', 'gene4686', 'gene4687', 'gene4699', 'gene4702', 'gene4706', 'gene4760', 'gene4774', 'gene4775', 'gene4796', 'gene4797', 'gene4800', 'gene4804', 'gene4805', 'gene4839', 'gene4898', 'gene4899', 'gene4900', 'gene4904', 'gene4931', 'gene4932', 'gene4997', 'gene5001', 'gene5010', 'gene5011', 'gene5013', 'gene5015', 'gene503', 'gene504', 'gene5072', 'gene5073', 'gene5087', 'gene5096', 'gene5098', 'gene512', 'gene5163', 'gene5164', 'gene5165', 'gene5232', 'gene5233', 'gene5234', 'gene5259', 'gene5320', 'gene5322', 'gene5323', 'gene5324', 'gene5361', 'gene5366', 'gene5367', 'gene5368', 'gene5399', 'gene5446', 'gene5447', 'gene5463', 'gene566', 'gene570', 'gene572', 'gene607', 'gene623', 'gene63', 'gene649', 'gene694', 'gene69', 'gene729', 'gene754', 'gene774', 'gene807', 'gene812', 'gene853', 'gene855', 'gene86', 'gene883', 'gene888', 'gene88', 'gene896', 'gene904', 'gene911', 'gene932', 'gene939', 'gene961', 'gene988']

#genes not converged after 5 milion
v4=['gene1051', 'gene106', 'gene1090', 'gene1108', 'gene1121', 'gene1142', 'gene1151', 'gene1172', 'gene1200', 'gene1203', 'gene1279', 'gene1305', 'gene1338', 'gene1341', 'gene1345', 'gene1346', 'gene1350', 'gene1351', 'gene1352', 'gene1371', 'gene1404', 'gene1417', 'gene1424', 'gene1439', 'gene1446', 'gene1447', 'gene1457', 'gene1461', 'gene1462', 'gene1463', 'gene1470', 'gene1471', 'gene1483', 'gene1518', 'gene1522', 'gene1523', 'gene1527', 'gene1539', 'gene1544', 'gene1545', 'gene1558', 'gene1560', 'gene1585', 'gene1722', 'gene1729', 'gene1730', 'gene1733', 'gene1776', 'gene1797', 'gene1826', 'gene1894', 'gene1945', 'gene2061', 'gene2062', 'gene2180', 'gene2188', 'gene2189', 'gene2209', 'gene2263', 'gene2267', 'gene2285', 'gene2295', 'gene2318', 'gene2319', 'gene2340', 'gene2345', 'gene2346', 'gene2391', 'gene2392', 'gene2393', 'gene2404', 'gene2408', 'gene2422', 'gene2539', 'gene2543', 'gene2551', 'gene2554', 'gene2555', 'gene2605', 'gene2621', 'gene2622', 'gene2652', 'gene2703', 'gene2704', 'gene2795', 'gene2814', 'gene2838', 'gene2861', 'gene2949', 'gene2950', 'gene2954', 'gene2972', 'gene2976', 'gene2977', 'gene3015', 'gene3031', 'gene3062', 'gene3087', 'gene3091', 'gene3100', 'gene310', 'gene3111', 'gene3125', 'gene3201', 'gene3295', 'gene3301', 'gene3302', 'gene330', 'gene3316', 'gene3319', 'gene331', 'gene332', 'gene333', 'gene3344', 'gene3388', 'gene3403', 'gene3415', 'gene3436', 'gene3439', 'gene3463', 'gene3464', 'gene3465', 'gene347', 'gene3482', 'gene3532', 'gene3700', 'gene3732', 'gene3772', 'gene3806', 'gene3858', 'gene3861', 'gene3870', 'gene3895', 'gene3896', 'gene3944', 'gene3948', 'gene4007', 'gene4041', 'gene4154', 'gene4181', 'gene4183', 'gene4197', 'gene4198', 'gene4214', 'gene4227', 'gene4228', 'gene4235', 'gene4253', 'gene4264', 'gene4282', 'gene4336', 'gene433', 'gene439', 'gene4420', 'gene4435', 'gene4443', 'gene4444', 'gene4445', 'gene4470', 'gene4487', 'gene4623', 'gene4624', 'gene4635', 'gene4668', 'gene4685', 'gene4686', 'gene4687', 'gene4699', 'gene4702', 'gene4706', 'gene4760', 'gene4775', 'gene4796', 'gene4797', 'gene4800', 'gene4804', 'gene4805', 'gene4839', 'gene4898', 'gene4899', 'gene4900', 'gene4904', 'gene4931', 'gene4932', 'gene4997', 'gene5001', 'gene5010', 'gene5011', 'gene5013', 'gene5015', 'gene503', 'gene504', 'gene5072', 'gene5073', 'gene5087', 'gene5096', 'gene5098', 'gene512', 'gene5163', 'gene5164', 'gene5165', 'gene5232', 'gene5233', 'gene5234', 'gene5259', 'gene5320', 'gene5323', 'gene5361', 'gene5367', 'gene5368', 'gene5399', 'gene5447', 'gene566', 'gene570', 'gene572', 'gene607', 'gene63', 'gene649', 'gene694', 'gene69', 'gene729', 'gene812', 'gene853', 'gene86', 'gene883', 'gene896', 'gene904', 'gene932', 'gene939', 'gene961', 'gene988', 'gene754', 'gene3438', 'gene2875', 'gene4648']


# taking the genes argument from the gwf workflow
parser = argparse.ArgumentParser()
parser.add_argument("genes") #genes from the list of converged genes
args = parser.parse_args()
genes = str(args.genes)

# Make the MrBayes block for the genes according to how many generations it ran
#if the genes had converged by 2.5 milion generations
if genes not in v2:
        with open(genes+'_mb_sumt.nex', 'a') as file:
            mb_command=["begin mrbayes;\n\n", "\t Execute /home/kris/dypsidinae/C_large_dataset/7.Nex_files_n/"+genes+"_no_X-out.nex;\n", "\t sumt conformat=simple;\n","END;"]
            for i in mb_command:
                file.write(i)
#If the genes converged by 3.5 milion generation
elif genes in v2 and genes not in v3:
        with open(genes+'_mb_sumt.nex', 'a') as file:
            mb_command=["begin mrbayes;\n\n", "\t Execute /home/kris/dypsidinae/C_large_dataset/7.Nex_files_n/"+genes+"_no_X-out.nex;\n", "\t sumt relburnin=no burnin=650 conformat=simple;\n","END;"]
            for i in mb_command:
                file.write(i)
#If the genes converged by 5 milion generations
elif genes in v3 and genes not in v4:
       with open(genes+'_mb_sumt.nex', 'a') as file:
            mb_command=["begin mrbayes;\n\n", "\t Execute /home/kris/dypsidinae/C_large_dataset/7.Nex_files_n/"+genes+"_no_X-out.nex;\n", "\t sumt relburnin=no burnin=1250 conformat=simple;\n","END;"]
            for i in mb_command:
                file.write(i) 
#if the genes converged after 7.5 milion generations
elif genes in v4:
       with open(genes+'_mb_sumt.nex', 'a') as file:
            mb_command=["begin mrbayes;\n\n", "\t Execute /home/kris/dypsidinae/C_large_dataset/7.Nex_files_n/"+genes+"_no_X-out.nex;\n", "\t sumt relburnin=no burnin=2250 conformat=simple;\n","END;"]
            for i in mb_command:
                file.write(i) 



