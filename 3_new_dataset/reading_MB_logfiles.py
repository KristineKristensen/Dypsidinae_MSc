import os, csv, argparse
os.chdir("/home/kris/dypsidinae/C_large_dataset/8.MrBayes/")

# The genes for which convergence is tested
genes =['gene1000','gene1002','gene1003','gene1004','gene1005','gene1006','gene1008','gene1009','gene1010','gene1011','gene1012','gene1014','gene1015','gene1016','gene1019','gene1021','gene1022','gene1023','gene1024','gene1025','gene1026','gene1027','gene1028','gene1033','gene1034','gene1035','gene1036','gene1038','gene1039','gene1040','gene1041','gene1042','gene1051','gene1052','gene1053','gene1054','gene1063','gene1064','gene1065','gene1066','gene1067','gene1069','gene106','gene1071','gene1072','gene1073','gene1074','gene1075','gene1076','gene1079','gene107','gene1080','gene1082','gene1083','gene1084','gene1085','gene1086','gene1087','gene1088','gene1089','gene108','gene1090','gene1097','gene109','gene10','gene1100','gene1101','gene1102','gene1103','gene1107','gene1108','gene110','gene1112','gene1114','gene1115','gene1116','gene1117','gene1118','gene111','gene1120','gene1121','gene1122','gene1130','gene1131','gene1132','gene1137','gene1138','gene1139','gene1142','gene1143','gene1144','gene1145','gene1146','gene1147','gene1148','gene114','gene1151','gene1156','gene1158','gene1159','gene115','gene1160','gene1167','gene1168','gene1169','gene116','gene1170','gene1171','gene1172','gene1173','gene1174','gene1175','gene1177','gene1186','gene1187','gene1188','gene1189','gene118','gene1190','gene1191','gene1192','gene1193','gene1194','gene1196','gene1199','gene119','gene11','gene1200','gene1202','gene1203','gene1204','gene1205','gene120','gene1210','gene1211','gene1212','gene1213','gene121','gene1222','gene1223','gene1224','gene1226','gene1227','gene1228','gene122','gene1233','gene1234','gene1235','gene1243','gene1244','gene1245','gene1246','gene1247','gene1248','gene1249','gene1250','gene1251','gene1252','gene1254','gene1255','gene1256','gene1257','gene1258','gene1259','gene1260','gene1261','gene1262','gene1263','gene1264','gene1266','gene1267','gene1268','gene1269','gene126','gene1270','gene1271','gene1272','gene1273','gene1274','gene1275','gene1276','gene1277','gene1278','gene1279','gene127','gene128','gene1295','gene1297','gene1298','gene129','gene12','gene1305','gene1307','gene1308','gene1309','gene130','gene1315','gene1316','gene1318','gene1319','gene131','gene1320','gene1321','gene1322','gene1323','gene1326','gene1327','gene1328','gene132','gene1335','gene1336','gene1337','gene1338','gene1339','gene133','gene1341','gene1342','gene1343','gene1345','gene1346','gene1347','gene1348','gene1349','gene134','gene1350','gene1351','gene1352','gene1355','gene1356','gene1357','gene1358','gene1359','gene135','gene1360','gene1361','gene1362','gene1364','gene1365','gene1366','gene1367','gene1369','gene136','gene1370','gene1371','gene1372','gene1373','gene1374','gene1375','gene1379','gene137','gene1380','gene1381','gene1382','gene1383','gene1384','gene1385','gene1386','gene1388','gene1389','gene138','gene1390','gene1391','gene1392','gene1393','gene1394','gene1395','gene1396','gene1397','gene1398','gene1399','gene139','gene13','gene1400','gene1401','gene1402','gene1403','gene1404','gene1406','gene1407','gene1408','gene1409','gene1410','gene1411','gene1412','gene1413','gene1414','gene1415','gene1416','gene1417','gene1418','gene1419','gene1420','gene1421','gene1422','gene1423','gene1424','gene1425','gene1426','gene1427','gene1428','gene1429','gene142','gene1430','gene1431','gene1434','gene1435','gene1436','gene1438','gene1439','gene143','gene1440','gene1441','gene1442','gene1443','gene1444','gene1445','gene1446','gene1447','gene1448','gene1449','gene144','gene1450','gene1451','gene1452','gene1453','gene1454','gene1455','gene1456','gene1457','gene145','gene1460','gene1461','gene1462','gene1463','gene1464','gene1465','gene1466','gene1467','gene1468','gene1469','gene146','gene1470','gene1471','gene1474','gene1475','gene147','gene1483','gene1485','gene1486','gene1487','gene1488','gene1489','gene148','gene1490','gene1491','gene1492','gene1493','gene1494','gene1495','gene1496','gene1497','gene1498','gene1499','gene149','gene14','gene1500','gene1501','gene1502','gene1503','gene1504','gene1505','gene1506','gene150','gene1514','gene1515','gene1516','gene1517','gene1518','gene151','gene1522','gene1523','gene1525','gene1527','gene1528','gene1529','gene152','gene1530','gene1531','gene1532','gene1533','gene1534','gene1535','gene1536','gene1537','gene1538','gene1539','gene153','gene1540','gene1541','gene1542','gene1543','gene1544','gene1545','gene1548','gene1549','gene1550','gene1552','gene1553','gene1554','gene1555','gene1556','gene1557','gene1558','gene1560','gene1561','gene1562','gene1563','gene1564','gene1567','gene1568','gene1569','gene1571','gene1574','gene1575','gene1576','gene1578','gene1579','gene1580','gene1581','gene1583','gene1584','gene1585','gene1586','gene158','gene1590','gene1591','gene1592','gene1593','gene1594','gene1595','gene1596','gene1597','gene1598','gene1599','gene159','gene1600','gene1601','gene1602','gene1603','gene1604','gene1605','gene1606','gene1607','gene1608','gene1609','gene160','gene1610','gene1618','gene1619','gene161','gene1623','gene1624','gene1625','gene162','gene1631','gene1632','gene1633','gene1634','gene1635','gene1636','gene1637','gene1638','gene1639','gene163','gene1640','gene1641','gene1642','gene1652','gene1653','gene1654','gene1655','gene1656','gene1658','gene1659','gene1664','gene1665','gene1666','gene1667','gene1668','gene1669','gene1670','gene1671','gene1672','gene167','gene168','gene1690','gene1691','gene1692','gene1693','gene1694','gene1695','gene1696','gene1697','gene1698','gene169','gene1700','gene1701','gene1702','gene1703','gene1704','gene1705','gene1706','gene1707','gene1708','gene1709','gene170','gene1710','gene1711','gene1712','gene1713','gene1714','gene1715','gene1718','gene1719','gene171','gene1722','gene1724','gene1725','gene1729','gene172','gene1730','gene1731','gene1732','gene1733','gene1734','gene1735','gene1739','gene173','gene1740','gene1745','gene1747','gene1748','gene1750','gene1765','gene1766','gene176','gene1770','gene1771','gene1773','gene1774','gene1775','gene1776','gene1777','gene1778','gene1779','gene177','gene1780','gene1781','gene1782','gene1783','gene1784','gene178','gene1794','gene1795','gene1796','gene1797','gene1801','gene1802','gene1803','gene1808','gene1809','gene180','gene1812','gene1813','gene1817','gene1818','gene1819','gene181','gene1823','gene1824','gene1825','gene1826','gene1827','gene182','gene1831','gene1835','gene1836','gene1837','gene1839','gene183','gene1840','gene1841','gene1842','gene1844','gene1845','gene1846','gene1847','gene1848','gene1849','gene184','gene1850','gene1851','gene1852','gene1853','gene1855','gene1858','gene185','gene1863','gene1864','gene1865','gene1866','gene1869','gene1870','gene1871','gene1872','gene1874','gene1875','gene187','gene1891','gene1892','gene1893','gene1894','gene189','gene1903','gene1904','gene1905','gene1906','gene1907','gene1908','gene1909','gene1910','gene1911','gene1912','gene1913','gene1914','gene1915','gene1916','gene1917','gene1918','gene1919','gene191','gene1920','gene1921','gene1922','gene1924','gene1927','gene1928','gene192','gene1930','gene1931','gene1932','gene1933','gene1934','gene1937','gene193','gene1942','gene1943','gene1945','gene1947','gene1948','gene194','gene1951','gene1952','gene1953','gene195','gene1969','gene196','gene1970','gene1971','gene1972','gene1973','gene1974','gene1975','gene1976','gene1977','gene197','gene1981','gene1982','gene1989','gene198','gene1995','gene1996','gene1997','gene1','gene2001','gene2002','gene2003','gene2004','gene2009','gene200','gene2010','gene2011','gene2016','gene2017','gene2018','gene2019','gene201','gene2027','gene2031','gene2032','gene2033','gene2037','gene2045','gene2047','gene2048','gene2052','gene2053','gene2054','gene2055','gene2056','gene2058','gene2059','gene2060','gene2061','gene2062','gene2064','gene2065','gene2066','gene2067','gene2069','gene206','gene2071','gene2072','gene2073','gene2079','gene207','gene2083','gene2084','gene2085','gene2086','gene2095','gene2096','gene2097','gene2098','gene2099','gene209','gene20','gene2100','gene2101','gene2102','gene2103','gene2105','gene2106','gene2107','gene2108','gene2109','gene210','gene2110','gene2113','gene2114','gene2115','gene2116','gene2117','gene2118','gene2121','gene2125','gene2126','gene2127','gene2128','gene212','gene2132','gene2133','gene213','gene2142','gene2143','gene2144','gene2145','gene2146','gene214','gene2150','gene2152','gene2153','gene2154','gene215','gene2162','gene2163','gene2164','gene2167','gene216','gene2175','gene2176','gene2177','gene2178','gene217','gene2180','gene2181','gene2182','gene2183','gene2184','gene2185','gene2186','gene2187','gene2188','gene2189','gene2191','gene2192','gene2196','gene21','gene2207','gene2208','gene2209','gene220','gene221','gene2228','gene2229','gene222','gene2230','gene2231','gene2232','gene2233','gene2234','gene2235','gene2236','gene2237','gene2238','gene2239','gene223','gene2240','gene2241','gene2245','gene2246','gene2247','gene2248','gene224','gene2259','gene225','gene2261','gene2262','gene2263','gene2264','gene2265','gene2267','gene2268','gene226','gene2282','gene2283','gene2284','gene2285','gene2286','gene2287','gene2288','gene2289','gene2294','gene2295','gene2299','gene229','gene22','gene2302','gene2303','gene2304','gene2306','gene2307','gene2308','gene2309','gene2310','gene2311','gene2318','gene2319','gene2320','gene2321','gene2325','gene2326','gene2328','gene2329','gene2335','gene2336','gene2338','gene2339','gene233','gene2340','gene2342','gene2343','gene2344','gene2345','gene2346','gene2348','gene2349','gene234','gene2350','gene2354','gene2355','gene2356','gene2357','gene2358','gene2359','gene235','gene2360','gene2361','gene2362','gene2363','gene2364','gene236','gene2372','gene2377','gene2378','gene2379','gene237','gene2387','gene2388','gene2389','gene238','gene2390','gene2391','gene2392','gene2393','gene2394','gene2395','gene2396','gene2398','gene2399','gene23','gene2400','gene2402','gene2403','gene2404','gene2405','gene2407','gene2408','gene2409','gene2410','gene2415','gene2416','gene2417','gene2418','gene2419','gene241','gene2420','gene2422','gene2423','gene2424','gene2425','gene2429','gene2430','gene2431','gene2432','gene2435','gene2436','gene2437','gene243','gene2440','gene2441','gene2442','gene2443','gene2444','gene2445','gene2446','gene2448','gene2449','gene2450','gene2452','gene2453','gene2454','gene2455','gene2457','gene2458','gene2459','gene245','gene2460','gene2461','gene2462','gene2463','gene2464','gene2465','gene2466','gene2467','gene2468','gene2469','gene2473','gene2474','gene247','gene2480','gene2481','gene2483','gene2485','gene2486','gene2487','gene2488','gene2489','gene2491','gene2492','gene2494','gene2495','gene2496','gene249','gene24','gene2501','gene2502','gene2503','gene2504','gene2505','gene2507','gene2509','gene2512','gene2513','gene2514','gene2515','gene2516','gene2517','gene2518','gene2519','gene2520','gene2521','gene2522','gene2528','gene2529','gene252','gene2530','gene2538','gene2539','gene253','gene2540','gene2541','gene2542','gene2543','gene2545','gene2546','gene2547','gene2548','gene254','gene2551','gene2552','gene2554','gene2555','gene2556','gene2557','gene2558','gene2559','gene255','gene2560','gene2561','gene2562','gene2565','gene2566','gene2567','gene2568','gene2569','gene256','gene2570','gene2571','gene2576','gene2577','gene257','gene2580','gene2581','gene2582','gene2583','gene2584','gene2585','gene2586','gene2587','gene2588','gene2589','gene258','gene2590','gene2591','gene2592','gene2593','gene2597','gene259','gene2602','gene2603','gene2604','gene2605','gene2606','gene2607','gene2608','gene2609','gene2611','gene2613','gene2614','gene2615','gene261','gene2621','gene2622','gene2623','gene2624','gene2625','gene262','gene2632','gene2633','gene2639','gene263','gene2640','gene2641','gene2642','gene2644','gene2645','gene2646','gene2647','gene2652','gene2658','gene2659','gene2660','gene2661','gene2662','gene2663','gene2664','gene2665','gene2666','gene2667','gene2668','gene2669','gene2670','gene2674','gene2681','gene2682','gene2683','gene2684','gene2685','gene2686','gene2687','gene2688','gene2689','gene2690','gene2691','gene2692','gene2697','gene2703','gene2704','gene2705','gene2706','gene2707','gene2711','gene2721','gene2724','gene2725','gene2726','gene2727','gene2728','gene2729','gene272','gene2730','gene2731','gene2732','gene2733','gene2734','gene2735','gene2736','gene2737','gene2738','gene2739','gene273','gene2740','gene2741','gene2742','gene2743','gene2744','gene2745','gene2746','gene2747','gene274','gene2754','gene2755','gene2756','gene2757','gene2759','gene275','gene2760','gene2761','gene2762','gene2763','gene276','gene2772','gene2773','gene2774','gene2775','gene2776','gene2777','gene2778','gene2779','gene2783','gene2784','gene2785','gene2787','gene2788','gene2789','gene2790','gene2793','gene2795','gene2796','gene2797','gene2798','gene2799','gene2800','gene2801','gene2808','gene2809','gene2810','gene2813','gene2814','gene2818','gene2819','gene2820','gene2823','gene2824','gene2825','gene2826','gene2827','gene2832','gene2835','gene2836','gene2837','gene2838','gene2839','gene2840','gene2841','gene2852','gene2853','gene2854','gene2855','gene2856','gene2857','gene2858','gene2859','gene2860','gene2861','gene286','gene2872','gene2873','gene2874','gene2875','gene2876','gene287','gene2883','gene2886','gene288','gene2891','gene2892','gene2894','gene289','gene2900','gene2901','gene2902','gene2903','gene2904','gene2907','gene2908','gene290','gene2917','gene2918','gene2919','gene291','gene2920','gene2921','gene2922','gene2923','gene2926','gene2927','gene2928','gene2929','gene292','gene2930','gene2931','gene2932','gene2936','gene2937','gene2938','gene2939','gene293','gene2940','gene2941','gene2942','gene2943','gene2944','gene2947','gene2948','gene2949','gene294','gene2950','gene2951','gene2953','gene2954','gene2955','gene2958','gene2959','gene295','gene2960','gene2961','gene2962','gene2963','gene2964','gene2965','gene2969','gene296','gene2970','gene2972','gene2973','gene2974','gene2975','gene2976','gene2977','gene297','gene2988','gene2989','gene298','gene299','gene2','gene3001','gene3002','gene3003','gene3004','gene3005','gene3006','gene3007','gene3008','gene3014','gene3015','gene3018','gene3019','gene3020','gene3021','gene3022','gene3023','gene3024','gene3027','gene3028','gene3029','gene3030','gene3031','gene3032','gene3033','gene3034','gene3035','gene3036','gene3037','gene3038','gene3039','gene303','gene3040','gene3041','gene3043','gene3044','gene3045','gene3062','gene3065','gene3067','gene3068','gene3069','gene3070','gene3071','gene3072','gene3073','gene307','gene3081','gene3082','gene3083','gene3084','gene3085','gene3086','gene3087','gene308','gene3090','gene3091','gene3092','gene3093','gene3094','gene3095','gene3096','gene3097','gene309','gene3100','gene3101','gene3102','gene3103','gene3104','gene3105','gene3106','gene310','gene3111','gene3112','gene3113','gene3114','gene311','gene3121','gene3124','gene3125','gene3129','gene3131','gene3132','gene3133','gene3134','gene3139','gene3142','gene315','gene3162','gene3163','gene3164','gene3165','gene3166','gene3169','gene3170','gene3171','gene3172','gene3173','gene3174','gene3175','gene3176','gene3177','gene3180','gene3181','gene3182','gene3183','gene3185','gene3188','gene3189','gene3191','gene31','gene3201','gene3212','gene3213','gene3214','gene3215','gene3217','gene3219','gene3220','gene3232','gene3233','gene3234','gene3235','gene3236','gene3237','gene3238','gene3239','gene3241','gene3242','gene3243','gene3244','gene3245','gene3246','gene3247','gene3248','gene3250','gene3251','gene3252','gene3253','gene3254','gene3255','gene3256','gene3258','gene3259','gene3260','gene3261','gene3262','gene3269','gene3270','gene3272','gene3276','gene3279','gene3280','gene3281','gene3282','gene3283','gene3284','gene3285','gene3286','gene3287','gene3288','gene3293','gene3294','gene3295','gene329','gene32','gene3301','gene3302','gene3303','gene3304','gene3305','gene3306','gene3307','gene3308','gene3309','gene330','gene3310','gene3311','gene3312','gene3313','gene3314','gene3316','gene3319','gene331','gene3325','gene3328','gene3329','gene332','gene3330','gene3331','gene3332','gene3333','gene3335','gene333','gene3340','gene3344','gene3345','gene3346','gene3347','gene334','gene3355','gene3356','gene3357','gene3358','gene3359','gene335','gene3360','gene3362','gene3363','gene336','gene3370','gene3371','gene3372','gene3373','gene3374','gene3375','gene3376','gene3377','gene3378','gene3379','gene337','gene3381','gene3387','gene3388','gene3389','gene3390','gene3391','gene3392','gene3393','gene3394','gene3395','gene3396','gene3397','gene33','gene3403','gene3406','gene3407','gene3412','gene3413','gene3414','gene3415','gene3418','gene3419','gene341','gene3420','gene3421','gene3425','gene3426','gene3427','gene3428','gene342','gene3432','gene3433','gene3434','gene3435','gene3436','gene3438','gene3439','gene3444','gene344','gene3450','gene3456','gene3457','gene345','gene3460','gene3463','gene3464','gene3465','gene3473','gene3474','gene3475','gene3476','gene3477','gene3478','gene3479','gene347','gene3480','gene3481','gene3482','gene3483','gene3488','gene348','gene3490','gene3492','gene3493','gene3494','gene3495','gene3496','gene3497','gene3498','gene3499','gene3500','gene3504','gene3505','gene3506','gene3507','gene3508','gene350','gene3510','gene3511','gene3512','gene3518','gene3523','gene3525','gene3526','gene3528','gene3529','gene3530','gene3531','gene3532','gene3538','gene3540','gene3544','gene3548','gene3549','gene354','gene3550','gene3551','gene3552','gene3557','gene3558','gene3559','gene3560','gene3562','gene3563','gene3564','gene3565','gene3566','gene3567','gene3573','gene3574','gene3575','gene3577','gene3578','gene3585','gene3586','gene3587','gene3588','gene3593','gene3594','gene3595','gene3596','gene3597','gene3598','gene3599','gene359','gene3600','gene3601','gene3602','gene3603','gene3604','gene3609','gene3610','gene3611','gene3613','gene3614','gene3615','gene3616','gene3617','gene3620','gene3621','gene3622','gene3623','gene3624','gene3625','gene3626','gene3627','gene362','gene3634','gene3635','gene3636','gene3637','gene3638','gene3641','gene3642','gene3649','gene3650','gene3651','gene3654','gene3655','gene3656','gene3657','gene3658','gene365','gene3660','gene366','gene3672','gene3673','gene3674','gene3675','gene3676','gene367','gene3680','gene3681','gene3682','gene3683','gene3684','gene3685','gene3686','gene3687','gene3688','gene368','gene3692','gene3693','gene3699','gene369','gene36','gene3700','gene3701','gene3702','gene3703','gene3704','gene3705','gene3706','gene3707','gene3708','gene3709','gene3710','gene3712','gene3713','gene3714','gene3715','gene3716','gene3717','gene3718','gene3719','gene3732','gene3733','gene3737','gene3738','gene3751','gene3752','gene3753','gene3754','gene3759','gene3760','gene3762','gene3763','gene3764','gene3770','gene3771','gene3772','gene3773','gene3774','gene3775','gene3776','gene3778','gene3779','gene3780','gene3781','gene3782','gene3785','gene3786','gene3787','gene3788','gene3789','gene3790','gene3791','gene3792','gene3793','gene3794','gene3795','gene3796','gene3799','gene37','gene3802','gene3803','gene3804','gene3805','gene3806','gene3807','gene3808','gene3809','gene380','gene3810','gene3811','gene3812','gene3813','gene3814','gene3815','gene3816','gene3818','gene3820','gene3821','gene3822','gene3823','gene3826','gene3831','gene3836','gene3838','gene3842','gene3843','gene3847','gene3848','gene3849','gene3850','gene3851','gene3852','gene3853','gene3854','gene3855','gene3858','gene385','gene3861','gene3862','gene3863','gene3864','gene3865','gene3866','gene3867','gene3868','gene3869','gene386','gene3870','gene3872','gene3878','gene3879','gene3880','gene3881','gene3882','gene3883','gene3884','gene3885','gene3886','gene3895','gene3896','gene3897','gene3898','gene389','gene3907','gene390','gene3910','gene3911','gene3912','gene3913','gene3914','gene3915','gene3916','gene3917','gene3918','gene3919','gene391','gene3920','gene3924','gene3926','gene3927','gene3928','gene392','gene3931','gene3939','gene393','gene3941','gene3942','gene3943','gene3944','gene3947','gene3948','gene3949','gene394','gene3950','gene395','gene3962','gene3963','gene3964','gene3965','gene3966','gene3967','gene3968','gene3969','gene396','gene3976','gene3977','gene3978','gene3979','gene3980','gene3983','gene3984','gene3985','gene3986','gene3990','gene3993','gene3995','gene3996','gene3997','gene3998','gene3999','gene3','gene4000','gene4003','gene4004','gene4005','gene4006','gene4007','gene4009','gene400','gene4013','gene4014','gene4015','gene4016','gene4017','gene4018','gene4019','gene401','gene4020','gene4021','gene4022','gene4023','gene4024','gene4025','gene4026','gene4027','gene4028','gene402','gene4032','gene4034','gene4035','gene4036','gene4037','gene4038','gene4039','gene403','gene4040','gene4041','gene4042','gene4043','gene4044','gene4045','gene4046','gene4047','gene4055','gene4056','gene4057','gene4058','gene4059','gene4060','gene4062','gene4063','gene4064','gene4065','gene4066','gene4069','gene4073','gene4074','gene4083','gene4084','gene4085','gene4086','gene4098','gene4099','gene409','gene4100','gene4103','gene4104','gene4105','gene4109','gene410','gene4110','gene4113','gene4114','gene4115','gene4116','gene4117','gene4118','gene4119','gene411','gene4120','gene4124','gene4125','gene4126','gene4127','gene4128','gene4129','gene412','gene4130','gene4133','gene4134','gene4135','gene4136','gene413','gene4146','gene4147','gene4148','gene4149','gene4150','gene4151','gene4152','gene4154','gene4155','gene4156','gene4157','gene4158','gene4159','gene4160','gene4161','gene4163','gene4164','gene4165','gene4166','gene4176','gene4177','gene4180','gene4181','gene4182','gene4183','gene4184','gene418','gene4191','gene4192','gene4195','gene4196','gene4197','gene4198','gene4200','gene4201','gene4205','gene4206','gene4207','gene4208','gene4209','gene4210','gene4211','gene4212','gene4213','gene4214','gene4216','gene421','gene4220','gene4221','gene4222','gene4223','gene4224','gene4225','gene4226','gene4227','gene4228','gene422','gene4231','gene4235','gene4236','gene4237','gene4238','gene4239','gene4240','gene4241','gene4242','gene4246','gene4247','gene4248','gene4251','gene4252','gene4253','gene4254','gene4258','gene4263','gene4264','gene426','gene4277','gene4278','gene4279','gene427','gene4280','gene4281','gene4282','gene4283','gene4286','gene4289','gene428','gene429','gene4300','gene4301','gene4302','gene4304','gene4307','gene430','gene4310','gene4311','gene4312','gene4314','gene4316','gene4317','gene431','gene4327','gene432','gene4336','gene4337','gene4338','gene4339','gene433','gene4343','gene4344','gene4348','gene4349','gene434','gene4350','gene4351','gene4352','gene4353','gene4354','gene4355','gene4356','gene4359','gene435','gene4362','gene4368','gene4369','gene436','gene4373','gene4374','gene4375','gene4377','gene4378','gene4379','gene4380','gene4381','gene4382','gene4383','gene4384','gene4385','gene4387','gene4389','gene438','gene4394','gene4395','gene4396','gene4397','gene4398','gene439','gene43','gene4404','gene4406','gene4409','gene4410','gene4411','gene4412','gene4413','gene4417','gene4418','gene4419','gene4420','gene4421','gene4422','gene4423','gene4424','gene4425','gene4426','gene4427','gene4428','gene4429','gene442','gene4430','gene4431','gene4432','gene4433','gene4434','gene4435','gene4436','gene4437','gene4439','gene443','gene4440','gene4441','gene4442','gene4443','gene4444','gene4445','gene4446','gene4447','gene4448','gene444','gene445','gene4461','gene4465','gene4466','gene4467','gene446','gene4470','gene4473','gene4474','gene4475','gene4476','gene4477','gene4478','gene4479','gene4480','gene4481','gene4486','gene4487','gene4488','gene4489','gene448','gene4490','gene4491','gene4492','gene4493','gene4494','gene4495','gene4496','gene4497','gene4499','gene449','gene44','gene4500','gene4501','gene4502','gene4503','gene4504','gene4505','gene4508','gene4509','gene450','gene4514','gene4515','gene4516','gene4517','gene4518','gene4519','gene451','gene4520','gene4523','gene4524','gene4525','gene4527','gene4529','gene452','gene4530','gene4531','gene4537','gene4539','gene453','gene4540','gene4541','gene4542','gene4543','gene4544','gene4545','gene4546','gene4547','gene454','gene4550','gene4551','gene4552','gene4553','gene4554','gene4555','gene4556','gene4557','gene4558','gene4560','gene4567','gene4568','gene4569','gene456','gene4572','gene4577','gene4578','gene4579','gene457','gene4582','gene4584','gene4585','gene4586','gene4587','gene4588','gene4589','gene458','gene4593','gene4594','gene4598','gene4599','gene45','gene4600','gene4601','gene4602','gene4603','gene4604','gene4605','gene4606','gene4607','gene4608','gene4609','gene4611','gene4612','gene4613','gene4614','gene4615','gene4616','gene4617','gene4618','gene4619','gene4620','gene4621','gene4622','gene4623','gene4624','gene4625','gene4626','gene4627','gene462','gene4631','gene4633','gene4635','gene4636','gene4637','gene4638','gene463','gene4642','gene4643','gene4644','gene4645','gene4646','gene4647','gene4648','gene464','gene4655','gene4656','gene4657','gene4658','gene4659','gene465','gene4660','gene4661','gene4662','gene4663','gene4664','gene4665','gene4668','gene466','gene4670','gene4671','gene4672','gene4674','gene4676','gene4677','gene4678','gene467','gene4684','gene4685','gene4686','gene4687','gene468','gene4691','gene4692','gene4694','gene4698','gene4699','gene469','gene46','gene4700','gene4701','gene4702','gene4706','gene4707','gene4708','gene4709','gene4710','gene4713','gene4720','gene4721','gene4722','gene4723','gene4724','gene4725','gene4726','gene4727','gene4728','gene4729','gene4733','gene4734','gene473','gene4743','gene4747','gene4748','gene4749','gene474','gene4750','gene4751','gene4754','gene4756','gene4757','gene4758','gene475','gene4760','gene4761','gene4764','gene4769','gene476','gene4770','gene4771','gene4772','gene4773','gene4774','gene4775','gene4776','gene4777','gene4778','gene4779','gene477','gene4780','gene4784','gene478','gene4792','gene4793','gene4794','gene4795','gene4796','gene4797','gene4800','gene4801','gene4804','gene4805','gene481','gene4823','gene4824','gene482','gene4830','gene4831','gene4832','gene4834','gene4835','gene4836','gene4837','gene4839','gene483','gene4844','gene4845','gene4846','gene4847','gene4848','gene4849','gene484','gene4850','gene4851','gene4852','gene4853','gene4854','gene4855','gene4856','gene4857','gene485','gene4866','gene4867','gene4868','gene486','gene4877','gene4878','gene4886','gene4887','gene4889','gene4898','gene4899','gene489','gene4900','gene4903','gene4904','gene4907','gene490','gene4911','gene4912','gene491','gene4921','gene4929','gene492','gene4931','gene4932','gene4933','gene4935','gene4937','gene4938','gene4939','gene493','gene4940','gene4941','gene4942','gene4943','gene4944','gene4945','gene4946','gene4947','gene4948','gene4949','gene4950','gene4951','gene4953','gene4954','gene4968','gene4974','gene4975','gene4976','gene4977','gene4978','gene4979','gene4980','gene4981','gene4982','gene4983','gene4984','gene4985','gene4986','gene4987','gene4988','gene4990','gene4991','gene4992','gene4993','gene4994','gene4995','gene4996','gene4997','gene49','gene5000','gene5001','gene5002','gene5005','gene5006','gene5007','gene5008','gene5009','gene5010','gene5011','gene5013','gene5014','gene5015','gene5016','gene5017','gene5018','gene5025','gene5026','gene5027','gene5028','gene502','gene5033','gene5034','gene5035','gene5038','gene5039','gene503','gene5040','gene5041','gene5042','gene5043','gene5049','gene504','gene5056','gene5057','gene5058','gene5059','gene5060','gene5066','gene5067','gene5068','gene5069','gene5072','gene5073','gene5074','gene5079','gene5080','gene5081','gene5082','gene5083','gene5084','gene5086','gene5087','gene5089','gene508','gene5091','gene5092','gene5095','gene5096','gene5097','gene5098','gene5099','gene50','gene5100','gene5103','gene5104','gene5105','gene5106','gene5107','gene5110','gene5111','gene5119','gene511','gene5120','gene5121','gene5122','gene5124','gene5128','gene5129','gene512','gene5130','gene5131','gene5132','gene5133','gene5134','gene5135','gene5136','gene5137','gene5140','gene5142','gene5143','gene5144','gene5145','gene5146','gene5147','gene5148','gene5149','gene5150','gene5158','gene5159','gene515','gene5161','gene5162','gene5163','gene5164','gene5165','gene5166','gene5167','gene5168','gene5169','gene516','gene5170','gene5171','gene5172','gene5173','gene5174','gene5175','gene5176','gene5179','gene5180','gene5181','gene5187','gene5188','gene5189','gene5190','gene5191','gene5192','gene5193','gene5194','gene5195','gene5196','gene5197','gene5198','gene5199','gene51','gene5200','gene5201','gene5202','gene5203','gene5205','gene5206','gene5208','gene5213','gene5214','gene5215','gene5216','gene5217','gene5218','gene5219','gene5220','gene5221','gene5222','gene5225','gene5231','gene5232','gene5233','gene5234','gene5235','gene5236','gene5238','gene5239','gene5240','gene5241','gene5242','gene5244','gene5245','gene5247','gene5248','gene5249','gene5253','gene5254','gene5255','gene5256','gene5257','gene5258','gene5259','gene525','gene5261','gene5262','gene5263','gene5264','gene526','gene5271','gene5272','gene5273','gene5274','gene5275','gene5277','gene5278','gene527','gene5285','gene5286','gene528','gene5299','gene529','gene52','gene5300','gene5301','gene5302','gene5303','gene5304','gene5305','gene5306','gene5307','gene5308','gene5309','gene530','gene5310','gene5311','gene531','gene5320','gene5321','gene5322','gene5323','gene5324','gene5325','gene532','gene5330','gene5331','gene5332','gene5333','gene533','gene5342','gene5343','gene5344','gene5345','gene5346','gene534','gene5350','gene5351','gene5352','gene5355','gene5358','gene5359','gene535','gene5361','gene5362','gene5363','gene5364','gene5365','gene5366','gene5367','gene5368','gene5369','gene5370','gene5371','gene5372','gene5373','gene5376','gene5377','gene5382','gene5383','gene5384','gene5387','gene5388','gene5389','gene5390','gene5391','gene5392','gene5393','gene5394','gene5396','gene5397','gene5398','gene5399','gene53','gene5400','gene5401','gene5402','gene5403','gene5404','gene5405','gene5407','gene5415','gene5417','gene5418','gene5419','gene5420','gene5421','gene5422','gene5423','gene5424','gene5425','gene5426','gene5427','gene5428','gene5429','gene5430','gene5431','gene5432','gene5433','gene5434','gene5435','gene543','gene5440','gene5441','gene5442','gene5443','gene5444','gene5445','gene5446','gene5447','gene5448','gene5449','gene544','gene5450','gene5451','gene5452','gene5453','gene5454','gene5455','gene5456','gene5457','gene5458','gene545','gene5462','gene5463','gene5465','gene5466','gene5467','gene547','gene549','gene54','gene550','gene557','gene558','gene55','gene560','gene561','gene562','gene563','gene565','gene566','gene570','gene571','gene572','gene57','gene581','gene583','gene584','gene585','gene587','gene588','gene589','gene58','gene590','gene591','gene592','gene594','gene598','gene599','gene5','gene600','gene601','gene602','gene603','gene604','gene607','gene608','gene609','gene60','gene610','gene611','gene612','gene613','gene614','gene615','gene616','gene617','gene618','gene619','gene61','gene621','gene623','gene624','gene625','gene626','gene627','gene628','gene629','gene62','gene630','gene631','gene632','gene633','gene635','gene636','gene637','gene639','gene63','gene640','gene641','gene642','gene643','gene644','gene645','gene646','gene647','gene649','gene64','gene650','gene651','gene652','gene653','gene654','gene655','gene65','gene663','gene667','gene668','gene66','gene670','gene671','gene672','gene673','gene674','gene675','gene676','gene677','gene678','gene67','gene685','gene686','gene687','gene689','gene68','gene690','gene692','gene693','gene694','gene695','gene696','gene697','gene69','gene6','gene701','gene702','gene709','gene710','gene711','gene712','gene714','gene719','gene71','gene723','gene724','gene725','gene726','gene727','gene728','gene729','gene72','gene730','gene731','gene732','gene734','gene73','gene742','gene743','gene744','gene745','gene746','gene747','gene748','gene749','gene74','gene750','gene751','gene752','gene754','gene755','gene756','gene757','gene758','gene759','gene75','gene760','gene761','gene764','gene765','gene76','gene774','gene778','gene779','gene77','gene780','gene781','gene782','gene783','gene784','gene786','gene787','gene788','gene789','gene790','gene791','gene792','gene793','gene794','gene795','gene797','gene798','gene79','gene7','gene803','gene807','gene809','gene80','gene810','gene811','gene812','gene813','gene815','gene817','gene819','gene820','gene821','gene822','gene823','gene824','gene825','gene826','gene827','gene828','gene830','gene831','gene832','gene833','gene834','gene835','gene836','gene837','gene83','gene849','gene84','gene850','gene851','gene852','gene853','gene855','gene856','gene857','gene858','gene859','gene860','gene861','gene862','gene863','gene864','gene865','gene866','gene86','gene871','gene873','gene874','gene875','gene876','gene877','gene878','gene879','gene87','gene882','gene883','gene884','gene885','gene886','gene887','gene888','gene889','gene88','gene890','gene891','gene892','gene893','gene894','gene895','gene896','gene898','gene899','gene89','gene8','gene904','gene905','gene906','gene908','gene910','gene911','gene912','gene919','gene920','gene921','gene922','gene923','gene924','gene927','gene928','gene930','gene931','gene932','gene933','gene934','gene935','gene936','gene937','gene938','gene939','gene940','gene948','gene950','gene951','gene953','gene956','gene961','gene963','gene970','gene971','gene972','gene978','gene979','gene980','gene981','gene982','gene984','gene985','gene988','gene989','gene990','gene991','gene992','gene993','gene994','gene995','gene996','gene997','gene998','gene999','gene9']



data = [['gene', 'ASDSF','plot','ESS_min','PSRF_min', 'PSRF_max']]
for gene in genes:
    #Opening the log file from MrBayes
    gene_file=gene+"_output_tapper.fasta.log"
    if os.path.isfile(gene_file):
        list_with_data=[]
        list_with_data.append(gene)
        with open(gene_file, 'r') as f: 
            #Reading lines in the log file to find the line where the information is and the index of the line
            gene_log= f.readlines()
            for n, lines in enumerate(gene_log):
                if 'Average standard deviation of split frequencies:' in lines:
                    l_index= n
                if "+------------------------------------------------------------+" in lines:
                    index_n=n
                if "Parameter      Mean      Variance     Lower       Upper       Median    min ESS*  avg ESS    PSRF+ " in lines:
                    table_index=n
                    ESS_index= lines.index("min ESS*")
                    PSRF_index= lines.index("PSRF+")
                if "* Convergence diagnostic (ESS = Estimated Sample Size); min and avg values" in lines:
                    stop= n
            # Taking ASDF value
            list_with_data.append(gene_log[l_index][-10:-2])
            #Check the plot in the log file that show if the two runs are similar
            plots=gene_log[index_n+1:index_n+16]
            if  any("1" in l and "2" in l for l in plots):
                list_with_data.append("good")
            else:
                list_with_data.append("problem")
                
            #check ESS
            table_values= gene_log[table_index+2:stop-1]
            ESS_values=[]
            for v in table_values:
                ESS_values.append(v[ESS_index-1:ESS_index+6])
            ESS_min=min(ESS_values)
            list_with_data.append(ESS_min)
                
            #Check PSRF
            table_values= gene_log[table_index+2:stop-1]
            PSRF_values=[]
            for v in table_values:
                PSRF_values.append(v[PSRF_index-1:PSRF_index+4])
            PSRF_min=min(PSRF_values)
            PSRF_max=max(PSRF_values)
            list_with_data.append(PSRF_min)
            list_with_data.append(PSRF_max)
            
            data.append(list_with_data)    
    else:
        #Making a file that lists the genes for which no log file was made by MrBayes
        with open('mb_not_made.txt', 'a') as f:
            f.write(gene+"\n")

#Making a CSV file with the convergence information
with open('mb_records.csv', 'a', newline='') as csvfile:
    new_file= csv.writer(csvfile, delimiter =";")
    new_file.writerows(data)


